<div align="center">
  <a href="https://imgur.com/k4VWmn7">
    <img src="https://i.imgur.com/k4VWmn7.png" title="source: imgur.com" width="350" />
  </a>
</div>

## Secure, Automated, and Multi-Cloud Bitwarden Backup and Import System

Lazywarden is a Python automation tool designed to Backup and Restore data from your vault, including Bitwarden attachments. It allows you to upload backups to multiple cloud storage services and receive notifications across multiple platforms. It also offers AES encrypted backups and uses key derivation with Argon2, ensuring maximum security for your data.

## <span style="display: flex; align-items: center;"><img src="https://raw.githubusercontent.com/querylab/svg/main/start.gif" width="50" style="vertical-align: middle; margin-right: 10px;"> Features</span>

- üîí **Maximum Security:** Data protection with AES-256 encryption and Argon2 key derivation.
- üîÑ **Automated Backups and Imports:** Keep your Bitwarden vault up to date and secure.
- ‚úÖ **Integrity Verification:** SHA-256 hash to ensure data integrity on every backup.
- ‚òÅÔ∏è **Multi-Cloud Support:** Store backups to services such as Dropbox, Google Drive, pCloud, MEGA, NextCloud, Seafile, Storj, Cloudflare R2, Filebase (IPFS) and via SMTP.
- üñ•Ô∏è **Local Storage:** Save backups to a local path for greater control.
- üîî **Real-Time Alerts:** Instant notifications on Discord, Telegram and Slack.
- üóìÔ∏è **Schedule Management:** Integration with CalDAV, Todoist and Vikunja to manage your schedule.
- üê≥ **Easy Deployment:** Quick setup with Docker Compose.
- ü§ñ **Full Automation and Custom Scheduling:** Automatic backups with flexible scheduling options (daily, weekly, monthly, yearly). Integration with CalDAV, Todoist and Vikunja for complete tracking and email notifications.
- üîë **Bitwarden Export to KeePass:** Export Bitwarden items to a KeePass database (kdbx), including TOTP-seeded logins, URI, custom fields, card, identity attachments and secure notes.

## <span style="display: inline-flex; align-items: center;"><img src="https://media.tenor.com/-AyTtMgs2mMAAAAi/nyan-cat-nyan.gif" width="60" style="vertical-align: middle; margin-right: 10px;"> Platform Compatibility</span>


<div style="display: flex; justify-content: space-around;">
    <a href="https://imgur.com/Xz2k5O8"><img src="https://i.imgur.com/Xz2k5O8.png" title="source: imgur.com" width="30"/></a>
    <a href="https://imgur.com/9oZa9uU"><img src="https://imgur.com/9oZa9uU.png" title="source: imgur.com" width="30"/></a>
    <a href="https://imgur.com/jWZzbvl"><img src="https://imgur.com/jWZzbvl.png" title="source: imgur.com" width="30"/></a>
    <a href="https://imgur.com/O0PZyxN"><img src="https://i.imgur.com/O0PZyxN.png" title="source: imgur.com" width="30"/></a>
    <a href="https://imgur.com/aa100eH"><img src="https://i.imgur.com/aa100eH.png" title="source: imgur.com" width="30"/></a>
    <a href="https://imgur.com/Grlq9aN"><img src="https://i.imgur.com/Grlq9aN.png" title="source: imgur.com" width="30"/></a>
    <a href="https://imgur.com/UYGpfR8"><img src="https://i.imgur.com/UYGpfR8.png" title="source: imgur.com" width="30"/></a>
    <a href="https://imgur.com/SVshyRn"><img src="https://imgur.com/SVshyRn.png" title="source: imgur.com" width="30"/></a>
    <a href="https://imgur.com/G37MsuK"><img src="https://i.imgur.com/G37MsuK.png" title="source: imgur.com" width="30"/></a>
    <a href="https://imgur.com/XpWPF0w"><img src="https://i.imgur.com/XpWPF0w.png" title="source: imgur.com" width="30"/></a>
    <a href="https://imgur.com/YMGE85n"><img src="https://i.imgur.com/YMGE85n.png" title="source: imgur.com" width="30"/></a>
    <a href="https://imgur.com/w9PULK5"><img src="https://i.imgur.com/w9PULK5.png" title="source: imgur.com" width="30"/></a>
    <a href="https://imgur.com/hjuaEcF"><img src="https://i.imgur.com/hjuaEcF.png" title="source: imgur.com" width="30"/></a>
    <a href="https://imgur.com/BhI5DBR"><img src="https://imgur.com/BhI5DBR.png" title="source: imgur.com" width="30"/></a>
    <a href="https://imgur.com/krgaizW"><img src="https://imgur.com/krgaizW.png" title="source: imgur.com" width="30"/></a>
    <a href="https://imgur.com/hRwMM9n"><img src="https://imgur.com/hRwMM9n.png" title="source: imgur.com" width="30"/></a>
    <a href="https://imgur.com/zdTnwat"><img src="https://imgur.com/zdTnwat.png" title="source: imgur.com" width="30"/></a>
    <a href="https://imgur.com/i1hBmAD"><img src="https://imgur.com/i1hBmAD.png" title="source: imgur.com" width="30"/></a>

## <span style="display: inline-flex; align-items: center;"><img src="https://user-images.githubusercontent.com/74038190/212257472-08e52665-c503-4bd9-aa20-f5a4dae769b5.gif" width="36" style="vertical-align: middle; margin-right: 10px;"> Demo Backup</span>


<img src="https://raw.githubusercontent.com/querylab/svg/main/lazy-oficial.gif" />

<img src="https://raw.githubusercontent.com/querylab/svg/main/lazy-video.gif" />


## <span style="display: inline-flex; align-items: center;"> <img src="https://raw.githubusercontent.com/querylab/svg/main/server2.gif" width="50" style="vertical-align: middle; margin-right: 10px;"> <img src="https://raw.githubusercontent.com/querylab/svg/main/process2.gif" width="50" style="vertical-align: middle; margin-right: 15px;"> System Requirements </span>
- **Operating System**: Compatible with major Linux distributions

	- ‚úÖ Ubuntu
	- ‚úÖ Debian

## <span style="display: inline-flex; align-items: center;"><img src="https://github.com/Anmol-Baranwal/Cool-GIFs-For-GitHub/assets/74038190/2c0eef4b-7b75-42bd-9722-4bea97a2d532" width="60" style="vertical-align: middle; margin-right: 15px;">Installation</span>
###  Clone the repository

 ``` BASH
    git clone https://github.com/querylab/lazywarden.git
    cd lazywarden
```

### Configure Environment Variables & Bitwarden Secrets Manager

- Create a `.env` file based on the on this `.env.sample` example file and fill in the necessary variables.

``` BASH
# Bitwarden Secrets
BW_URL=80607bef-1153-4eb6-1111-b1a0013ebdd1
BW_USERNAME=c6a5fc4d-6d36-1111-820a-a1dae99e2f43
BW_PASSWORD=0de9c3be-253d-1111-be10-de0607329ffa
BW_TOTP_SECRET=01726d37-0df7-1111-a78d-96fdc8efd59b
ENCRYPTION_PASSWORD=588b0643-1111-4a78-ba3e-9467ad9c81a7
ZIP_PASSWORD=3bcadf27-446d-47f0-1111-b1469fa58546
ZIP_ATTACHMENT_PASSWORD=89d458e7-9ac4-1111-9f23-95cb4b8cff86

# pCloud Credentials
PCLOUD_USERNAME=8d5f981b-705a-1111-a25d-a2abe925f4e4
PCLOUD_PASSWORD=23351280-0184-1111-99b0-2b6a1bc921ae

# Mega Credentials
MEGA_EMAIL=1dafc95a-63c2-4b66-1111-bd7cd5a2ea5e
MEGA_PASSWORD=51bec27b-7c79-1111-9cef-1be72675a47f

# Dropbox Credentials
DROPBOX_ACCESS_TOKEN=647ff022-1111-47d9-a54f-fef635b23eff
DROPBOX_REFRESH_TOKEN=873e5430-1111-4d62-8bf2-acce1e915a9d
DROPBOX_APP_KEY=81f259ae-d6e4-47b1-1111-6bec568ddc85
DROPBOX_APP_SECRET=0b407a02-ded5-1111-b953-caf8fc79af99

# Todoist Credentials
TODOIST_TOKEN=667321ac-2229-42a1-1111-3c568c9d73e6

# CalDAV Credentials
CALDAV_URL=049c9267-bdb0-4266-1111-b19a00e9b626
CALDAV_USERNAME=6eff84c9-fbeb-1111-ad30-b19a00e9cc09
CALDAV_PASSWORD=492c37fd-46df-1111-abe7-b19a00e9e601

# Nextcloud Credentials
NEXTCLOUD_URL=e375df76-d3b2-1111-83ba-b19a0158fe08
# Example http://192.175.88.112:8400
NEXTCLOUD_USERNAME=a267c8cd-9d13-1111-8729-b19a0159276a
NEXTCLOUD_PASSWORD=7036175d-046b-1111-9797-b19a01594308

# Seafile Credentials
SEAFILE_SERVER_URL=20060dfc-4fa0-1111-8b41-b19b000857e7 
# Example http://192.175.88.212:8200
SEAFILE_USERNAME=9959dabb-ae4c-1111-9fc1-b19b00087d64
SEAFILE_PASSWORD=94e5f170-aedb-1111-b1b9-b19b00088ccd

# Filebase Credentials
FILEBASE_ACCESS_KEY=53ec784f-4b18-1111-9a47-b1a00136efc5
FILEBASE_SECRET_KEY=f99d8d83-57b9-1111-9ace-b1a001370117

# KeePass Password
KEEPASS_PASSWORD=95512b36-32e9-1111-9c15-b1ae0171b2f9

# Storj Credentials
STORJ_ACCESS_KEY=a7d85af3-ad63-1111-b039-b208012c381a
STORJ_SECRET_KEY=1303faf7-b34e-1111-ac43-b208012c4f05
STORJ_ENDPOINT=fb787806-a3f4-1111-8523-b208012c6543

# R2 Credentials
R2_ACCESS_KEY_ID=ffb0d6ed-1111-46ad-8fdf-b2080132c9dd
R2_SECRET_ACCESS_KEY=083b5344-1111-4dd8-909e-b2080132dc52
R2_ENDPOINT_URL=31510979-b5b1-1111-8957-b2080132f436

# Vikunja Credentials
VIKUNJA_API_TOKEN=7e67437c-1489-1111-8fbb-b20801880db2
VIKUNJA_URL=d3b7a73f-ebb9-1111-8dc2-b208018843a6 
#Example for Bitwarden Secret Manager http://192.175.88.227:3456/api/v1

# Google Drive Settings
GOOGLE_SERVICE_ACCOUNT_FILE=/root/lazywarden/config/bitwarden-drive-backup-google.json
GOOGLE_FOLDER_ID=1oWWis81111Tz5qRA3W4YTtO0LjvXFvoA

# Backup Settings
BACKUP_DIR=/root/lazywarden/backup-drive/
CRON_SCHEDULE="0 0 23 * *"
TIMEZONE=America/New_York
TIMESTAMP=2024_10_18_22_47_46

# API URLs for Bitwarden
API_URL=https://vault.bitwarden.com/api
IDENTITY_URL=https://vault.bitwarden.com/identity

# Organization ID
ORGANIZATION_ID=232c1890-1111-40b4-b769-b195012f78af

# Access Token for Bitwarden Authentication
ACCESS_TOKEN=0.34827757-1111-1111-1111-b20a01647f46.WDp3AUjnle1LqlXvs0Ox9xEWzgY8Hp:CKue3vgWTvIQzEmDlBlqGw==

# Notifications and Alerts
TELEGRAM_TOKEN=
TELEGRAM_CHAT_ID=
DISCORD_WEBHOOK_URL=
SLACK_WEBHOOK_URL=

# SMTP Configuration for Email Notifications
SMTP_SERVER=mail.smtp2go.com
SMTP_PORT=8025
SMTP_USERNAME=
SMTP_PASSWORD=
EMAIL_RECIPIENT=
SENDER_EMAIL=
```

### <img src="https://raw.githubusercontent.com/querylab/svg/main/ubuntu.gif" width="20" style="vertical-align: middle;"> Ubuntu Configuration

- Run the script to install all system dependencies and requirements
 
``` BASH
cd lazywarden/scripts
chmod +x setup-ubuntu-env.sh
./setup-ubuntu-env.sh
```


- Run this script to automatically install Docker & Docker-Compose:

```BASH
chmod +x docker-ubuntu.sh
./docker-ubuntu.sh
```

- First, ensure you are in the root directory of the project `lazywarden/`:

``` BASH
cd .. 
source venv/bin/activate
```

- Now Install Bitwarden CLI using the `bitwarden-cli-install.py` script, which will install all CLI dependencies:

``` PYTHON
python3 scripts/bitwarden-cli-install.py
```


- Change the system timezone using the following command. Replace `Region/City` with the desired timezone (e.g., `America/New_York`):

``` BASH
timedatectl set-timezone Region/City
```


- For example, to set the timezone to `America/New_York`, you would run:

``` BASH
timedatectl set-timezone America/New_York
```


- Run the Lazywarden program. Navigate to the `app/` folder and execute `main.py`:

``` PYTHON
cd app
python3 main.py
```

- In Ubuntu, if you encounter an error when running `main.py`, it may be related to missing or outdated libraries. To fix this, I recommend running the following command to install all the necessary dependencies:

``` PYTHON
 pip install -r requirements.txt
```

---

### <img src="https://raw.githubusercontent.com/querylab/svg/main/debian.png" width="20" style="vertical-align: middle;"> Debian Configuration

 - Run the script to install all system dependencies and requirements:
 
``` BASH
cd lazywarden/scripts
chmod +x setup-debian-env.sh
./setup-debian-env.sh
```

- Run this script to automatically install Docker & Docker-Compose:

```BASH
chmod +x docker-debian.sh
./docker-debian.sh
```

- First, ensure you are in the root directory of the project `lazywarden/`:

``` BASH
cd .. 
source venv/bin/activate
```

- Install Bitwarden CLI using the `bitwarden-cli-install.py` script, which will install all CLI dependencies:

``` PYTHON
python3 scripts/bitwarden-cli-install.py
```

- Change the system timezone using the following command. Replace `Region/City` with the desired timezone (e.g., `America/New_York`):

``` BASH
timedatectl set-timezone Region/City
```


- For example, to set the timezone to `America/New_York`, you would run:

``` BASH
timedatectl set-timezone America/New_York
```


- Run the Lazywarden program. Navigate to the `app/` folder and execute `main.py`:

``` PYTHON
cd app
python3 main.py
```

- In Debian, if you encounter an error when running `main.py`, it may be related to missing or outdated libraries. To fix this, I recommend running the following command to install all the necessary dependencies:

``` PYTHON
 pip install -r requirements.txt
```


### <img src="https://raw.githubusercontent.com/querylab/svg/main/tree2.gif" width="30" style="vertical-align: middle;">Tree Structure 

``` PYTHON

lazywarden/
‚îú‚îÄ‚îÄ app/                           # This directory appears to contain the main application code
‚îÇ   ‚îú‚îÄ‚îÄ backup.py                  # Backup functions
‚îÇ   ‚îú‚îÄ‚îÄ bitwarden_client.py        # Client to interact with Bitwarden
‚îÇ   ‚îú‚îÄ‚îÄ config.py                  # General application configurations
‚îÇ   ‚îú‚îÄ‚îÄ imports.py                 # Handles common imports
‚îÇ   ‚îú‚îÄ‚îÄ main.py                    # Main entry point of the application
‚îÇ   ‚îú‚îÄ‚îÄ notifications.py           # Handles notifications
‚îÇ   ‚îú‚îÄ‚îÄ secrets_manager.py         # Manages secrets
‚îÇ   ‚îú‚îÄ‚îÄ import_to_bitwarden.py     # Import your bitwarden vault
‚îÇ   ‚îú‚îÄ‚îÄ import_to_keepass.py       # Create kdbx database 
‚îÇ   ‚îú‚îÄ‚îÄ schedule_backup.py         # For create Schedule Backup
‚îú‚îÄ‚îÄ config/                        # Directory for configuration files
‚îÇ   ‚îú‚îÄ‚îÄ bitwarden-drive-backup-google.json # Configuration for Google Drive
‚îú‚îÄ‚îÄ scripts/                       # Directory for installation and setup scripts
‚îÇ   ‚îú‚îÄ‚îÄ bitwarden-cli-install.py   # Script to install the Bitwarden CLI
‚îÇ   ‚îú‚îÄ‚îÄ docker-debian.sh           # Setup script for Debian with Docker
‚îÇ   ‚îú‚îÄ‚îÄ docker-ubuntu.sh           # Setup script for Ubuntu with Docker
‚îÇ   ‚îú‚îÄ‚îÄ setup-debian-env.sh        # Environment setup for Debian
‚îÇ   ‚îú‚îÄ‚îÄ setup-ubuntu-env.sh        # Environment setup for Ubuntu
‚îÇ   ‚îú‚îÄ‚îÄ alldecrypt-zip.py          # Decrypt all zip files 
‚îÇ   ‚îú‚îÄ‚îÄ json-only-decrypt.py       # Decrypt only json files (optional)
‚îú‚îÄ‚îÄ backup-drive/
‚îÇ   ‚îú‚îÄ‚îÄ (This is where the generated backups will be stored local)
‚îú‚îÄ‚îÄ .env                           # File for environment variables
‚îú‚îÄ‚îÄ Dockerfile                     # Docker configuration file to create an application image
‚îú‚îÄ‚îÄ docker-compose.yml             # Docker Compose Configuration
‚îú‚îÄ‚îÄ entrypoint.sh                  # Entrypoint script for Docker
‚îî‚îÄ‚îÄ requirements.txt               # File that lists the project Python dependencies


```




### <img src="https://raw.githubusercontent.com/querylab/svg/main/whale1.gif" width="30" style="vertical-align: middle;"> Docker Compose

The Docker container will run the `main.py` script every 24 hours to back up Bitwarden and upload it to the configured cloud services. Notifications will be sent to the specified services in case of success or failure. You can modify the backup frequency according to your needs, such as monthly, daily, or hourly.

``` YAML
services:
  lazywarden:
    container_name: lazywarden
    hostname: lazywarden
    image: querylab/lazywarden:latest
    env_file:
      - .env
    environment:
      UNLOCK_VAULT: "true"
    volumes:
      - /root/lazywarden/config:/root/lazywarden/config
      - /root/lazywarden/backup-drive:/root/lazywarden/backup-drive/
      - /root/lazywarden/.env:/app/.env
    restart: unless-stopped
```

#### Run Docker Compose

- Run the Docker container

```DOCKER
docker compose up -d
```

#### Dockerfile

- The `Dockerfile` sets up the environment, installs dependencies, and copies necessary files into the container.

#### docker-compose.yml

- The `docker-compose.yml` file defines the lazywarden service and sets up environment variables and volumes for persistent storage.

### <img src="https://raw.githubusercontent.com/querylab/svg/main/alert1.gif" width="30" style="vertical-align: middle;"><img src="https://raw.githubusercontent.com/querylab/svg/main/cloud1.gif" width="30" style="vertical-align: middle;"><img src="https://raw.githubusercontent.com/querylab/svg/main/process2.gif" width="30" style="vertical-align: middle;"> Security Recommendation: Run in Local Environment 

- For security, run this project only in a local environment within your personal network. This significantly reduces the risk of exposure to external attacks, ensuring that sensitive data and credentials remain protected within a controlled environment.


### üì¢ Warning

##### **Important Note**

- Large attachments in your Bitwarden account (e.g., MP4 videos, MP3 files, high-resolution photos) may cause the backup process to take longer. Uploading these larger backups to cloud services will also be slower. Local storage and importing data are much faster in comparison.
- A high number of attachments can significantly extend the total backup time. Upload errors may occur when sending files to Dropbox, Google Drive, pCloud, MEGA, Seafile, Nextcloud, Storj, Cloudflare R2, or Filebase. If an error occurs, retrying the backup often resolves the issue.
- Configuring the Bitwarden Secret Manager is required for the program to function correctly. Even if you don't have an account, you must set a random variable to ensure proper operation.
- This program is compatible with both self-hosted Bitwarden and Vaultwarden instances.
- Import functionality for Vaultwarden and self-hosted Bitwarden is not yet implemented in the Bitwarden API.
- CalDAV calendar integration has only been tested with the following providers: [Baikal](https://github.com/sabre-io/Baikal), [Fruux](https://fruux.com), [Memotoo](https://www.memotoo.com), [Posteo](https://posteo.de), and [SOGo](https://www.sogo.nu/).
- Rotate the secrets stored in Bitwarden Secret Manager regularly for enhanced security.
- If you switch Bitwarden Accounts, make sure to run the `bw logout` command before logging into a new account.
- I run the program using the root user.




### <span style="display: inline-flex; align-items: center;"> <img src="https://user-images.githubusercontent.com/74038190/216122069-5b8169d7-1d8e-4a13-b245-a8e4176c99f8.png" width="30" style="vertical-align: middle; margin-right: 10px;"> Motivations </span>

- I created Lazywarden to Automate Bitwarden Backups without manual effort or exposing sensitive data. After struggling with complex tools, I leveraged Bitwarden Secret Manager to securely manage secrets. Lazywarden automates backups and uploads them to multiple cloud services (Google Drive, Dropbox, pCloud, MEGA, Seafile, Nextcloud, Filebase, Storj, Cloudflare R2), and integrates with Telegram, Discord, Slack, Todoist, Vikunja, and CalDAV for notifications and tracking. Its standout feature is the ability to restore encrypted backups back into Bitwarden, making backup management simple, secure, and efficient.

- If you like this project, please consider giving it a ‚≠ê


<div align="center">
  <a href="https://imgur.com/k4VWmn7">
    <img src="https://user-images.githubusercontent.com/74038190/216644507-4f06ea29-bf55-4356-aac0-d42751461a9d.gif" title="source: imgur.com" width="150" />
  </a>
</div>



